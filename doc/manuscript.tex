%---------------------------------------------
% This document is for pdflatex
%---------------------------------------------
\documentclass[11pt]{article}

\usepackage{amsmath,amsfonts,amssymb,graphicx,setspace,authblk}
\usepackage{float}
\usepackage[running]{lineno}
\usepackage[vmargin=1in,hmargin=1in]{geometry}
\usepackage[sc]{mathpazo} %Like Palatino with extensive math support

\usepackage[authoryear]{natbib}

\graphicspath{ {./../genetic-diversity/figures/} {./../community-turnover/figures/} }

\usepackage{enumitem}
\setlist{topsep=.125em,itemsep=-0.15em,leftmargin=0.75cm}

\usepackage{gensymb}

\usepackage[compact]{titlesec} 

\usepackage{bm,mathrsfs}

\usepackage{ifpdf}
\ifpdf
\DeclareGraphicsExtensions{.pdf,.png,.jpg}
\usepackage{epstopdf}
\else
\DeclareGraphicsExtensions{.eps}
\fi

\renewcommand{\floatpagefraction}{0.98}
\renewcommand{\topfraction}{0.99}
\renewcommand{\textfraction}{0.05}

\clubpenalty = 10000
\widowpenalty = 10000

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Just for commenting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[usenames]{color}
\newcommand{\new}{\textcolor{red}}
\newcommand{\spe}{\textcolor{blue}}
\newcommand{\comment}{\textcolor{red}}

\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\ba}{\begin{equation} \begin{aligned}}
\newcommand{\ea}{\end{aligned} \end{equation}}

\def\X{\mathbf{X}}

\floatstyle{boxed}
\newfloat{Box}{tbph}{box}

\title{\textbf{Matching the forecast horizon with the relevant spatial and temporal processes and data sources}}

\author[1]{Peter B. Adler}  
\author[2,3,4]{Ethan P. White}
\author[5]{Michael H. Cortez}
\affil[1]{Department of Wildland Resources and the Ecology Center, Utah State University, Logan, Utah}
\affil[2]{Department of Wildlife Ecology and Conservation, University of Florida, Gainesville, Florida}
\affil[3]{Informatics Institute, University of Florida, Gainesville, Florida}
\affil[4]{Biodiversity Institute, University of Florida, Gainesville, Florida}
\affil[5]{Department of Biological Science, Florida State University, Tallahasee, Florida}

\renewcommand\Authands{ and }

\date{}

\sloppy

\renewcommand{\baselinestretch}{1.25}

\begin{document}

\maketitle

\linenumbers

% rest of title page

\vspace{-1cm}

\noindent \emph{Statement of authorship:} PBA and EPW designed the study, PBA and MHC built the models, and PBA analyzed the models. PBA wrote the first draft of the manuscript, and all authors contributed substantially to revisions. 

\noindent \emph{Acknowledgements:} We thank Heather Lynch and Juan Manuel Morales for comments that improved early drafts of the paper. PBA was supported by the National Science Foundation (DEB-1927282) and the Utah Agriculture Experiment Station (grant 1322). EPW was supported by the Gordon and Betty Moore Foundationâ€™s Data-Driven Discovery Initiative (GBMF4563). 

%\noindent \emph{Running title:} Forecast horizon and ecological process

\vspace{0.25cm}

\noindent \textbf{Abstract:}   Most phenomenological, statistical models used to generate ecological forecasts take either a time-series approach, based on long-term data from one location, or a space-for-time approach, based on data describing spatial patterns across environmental gradients. \new{However, the magnitude and even the sign of environment-response relationships detected using these two approaches often differs, leading to contrasting predictions about responses to future environmental change.} Here we consider how the forecast horizon determines whether more accurate predictions come from the time-series approach, the space-for-time approach, or a combination of the two. We use two simulated case studies to show that forecasts for short and long forecast horizons need to focus on different ecological processes, which are reflected in different kinds of data. In the short-term, dynamics reflect initial conditions and fast processes such as birth and death, and the time-series approach makes the best predictions. In the long-term, dynamics reflect the additional influence of slower processes such as evolutionary and ecological selection, colonization and extinction, which the space-for-time approach can effectively capture. At intermediate time-scales, a weighted average of the two approaches shows promise. However, making this weighted model operational will require new research to predict the rate at which slow processes begin to influence dynamics.

\vspace{0.25cm}

\noindent \emph{Keywords:} dispersal, ecological forecasting, eco-evolutionary dynamics, global change, selection

\newpage 

\section*{Abstract} 
Most phenomenological, statistical models used to generate ecological forecasts take either a time-series approach, based on long-term data from one location, or a space-for-time approach, based on data describing spatial patterns across environmental gradients. \new{However, the magnitude and even the sign of environment-response relationships detected using these two approaches often differs, leading to contrasting predictions about responses to future environmental change.} Here we consider how the forecast horizon determines whether more accurate predictions come from the time-series approach, the space-for-time approach, or a combination of the two. We use two simulated case studies to show that forecasts for short and long forecast horizons need to focus on different ecological processes, which are reflected in different kinds of data. In the short-term, dynamics reflect initial conditions and fast processes such as birth and death, and the time-series approach makes the best predictions. In the long-term, dynamics reflect the additional influence of slower processes such as evolutionary and ecological selection, colonization and extinction, which the space-for-time approach can effectively capture. At intermediate time-scales, a weighted average of the two approaches shows promise. However, making this weighted model operational will require new research to predict the rate at which slow processes begin to influence dynamics.

\vspace{0.25cm}

\noindent \emph{Keywords:} dispersal, ecological forecasting, eco-evolutionary dynamics, global change, selection

\section*{Introduction}

Forecasting is increasingly recognized as important to the application and advancement of ecological research.
Forecasts are necessary to guide environmental policy and management
decisions about mitigation and adaption to global change \citep{clark_ecological_2001,mouquet_review:_2015,dietze_iterative_2018}.
But forecasts can also advance understanding of the processes governing ecological systems by providing rigorous tests of 
model predictions \citep{houlahan_priority_2017,dietze_prediction_2017,dietze_iterative_2018}.
The dual benefits of informing management and advancing basic knowledge 
makes forecasting an important priority for ecological research.

Statistical models used for ecological forecasting generally rely on either time-series approaches or space-for-time substitutions. The time-series approach involves fitting models to long-term datasets to describe the temporal dynamics of a system.  We then use those dynamic models to make predictions about what will happen in the future. This approach is often used to study population or vital rate fluctuations as a function of weather \citep{dalgleish_climate_2011}, or primary production as a function of annual precipitation \citep{lauenroth_long-term_1992}. When time-series models are fit with typically short ecological data sets, they capture ``fast processes'' operating on interannual time-scales, such as birth, death, individual growth, small-scale dispersal events, and short-term responses to environmental conditions (Fig. \ref{fig:fast-slow-concept}). Statistical models built using this approach normally cover a limited spatial extent (but see \citealt{Hefley2017,kleinhesselink_response_2018,Chevalier}), and ignore slower processes, such as evolutionary adaptation or turnover in community composition, that could influence dynamics at longer time scales \citep{clark_ecological_2001}. 

Space-for-time substitution approaches begin by describing how an ecological variable of interest, such as occupancy or productivity,  varies across sites experiencing different environmental conditions. These spatial relationships between environment and ecological response are assumed to also hold for changes at a site through time. To make a forecast, we first predict the future environmental conditions and then determine the associated ecological response, based on the observed spatial relationship.  This is the approach commonly used to predict population distribution or abundance as a function of climate \citep{elith_species_2009} or mean primary production as a function of mean precipitation \citep{Sala1988}. Space-for-time models capture the outcome of interactions between fast processes and slower processes operating over long time periods, such as immigration, extinction, and responses to large or prolonged environmental changes (Fig. \ref{fig:fast-slow-concept}). However, space-for-time models provide no information about how quickly the system will move from the current state to the predicted, future state. In fact, transient dynamics could prevent the system from ever reaching the predicted steady state \citep{Urban2012}. 

Although both time-series and space-for-time approaches are widely used, there has been little discussion of their advantages and disadvantages for guiding policy decisions or advancing our understanding of ecological dynamics \citep{harris_forecasting_2018,Renwick2018}. \new{Such a discussion is overdue given that these two approaches are likely to make very different predictions about ecological responses to future environmental change. For example, average forage production in the shortgrass steppe increases rapidly with increasing mean annual precipitation, but production is much less sensitive to interannual variation in precipitation at any one location \citep{lauenroth_long-term_1992}. The space-for-time approach would predict large changes in production in response to a future change in precipitation, while the time-series approach would predict smaller changes. Bird species' abundances in the United Kindgom also show different responses to spatial vs. temporal variation in weather covariates. Not only are abundances typically more sensitive to spatial variation in the covariates, but in many cases the temporal response takes the opposite sign \citep{Oedekoven2017}. Whenever the sign or magnitude of relationships based on time-series and space-for-time approaches differ, so will the resulting forecasts.}

Whether time-series models, space-for-time approaches, or some combination of the two will serve as the best source of 
information for forecasting may depend on how far into the future we are attempting to forecast \citep{harris_forecasting_2018}. 
This potential dependency on the ``forecast horizon'' (\textit{sensu} \citealt{Hyndman2018})
reflects lags in the response of ecological conditions to environmental change, shifts in the importance of ecological processes with
time scale \citep{levin_1992,rosenzweig_1995}, and differences between time-series and spatial gradients in the range of 
environmental conditions represented in observed data (Fig. \ref{fig:fast-slow-concept}).
At short forecast horizons (days to years), dynamics will reflect physiological and demographic responses and interactions
among the organisms present at a site more than temporal turnover of genotypes or species; 
environmental conditions are likely to stay within the range of historical variation; 
and the current state of the system is likely to capture the influence of unmeasured processes. As a result, 
for near-term forecasts time-series approaches may capture the key dynamics and provide accurate predictions.

In contrast, at long forecast horizons (decades to centuries),  environmental conditions that have not been 
historically observed are likely to not only occur but to persist long enough to drive significant turnover of genotypes and species 
through colonization and extinction as well as changes in the flux of energy and nutrients.  
At these long forecast horizons, the state of the system at the time the forecast is issued may be 
little help in predicting the future state. For the century-scale forecasts often featured in biodiversity and 
species-distribution modeling, space-for-time approaches may effectively capture the response of ecosystems to major shifts 
in climate over long periods, producing better long-term forecasts than time-series approaches. 
Using different modeling approaches for different forecast horizons is common in other disciplines.
For example, meteorological models for short-term weather forecasts differ substantially in spatial
and temporal resolution and extent from the global circulation models used to predict long-term changes
in climate.

Why not simply use process-based models to avoid the difficulties posed by phenomenological time-series and space-for-time modeling approaches? If we could accurately characterize all of the processes governing a system, then a model based on that understanding should make accurate predictions at all forecast horizons. Process-based models should also be more robust for making predictions outside of historically observed conditions and even beyond the conditions observed across spatial gradients, which will be especially important in a future with increasingly novel combinations of environment and species interactions \citep{Williams2007}. Unfortunately, in most cases this approach is not currently feasible because we lack a detailed knowledge of all the complex and interacting processes influencing the dynamics of real ecological systems. Even if the general form of the models were known, estimating the high number of parameters and quantifying how they vary across ecosystems typically requires more data than is currently available even for well-studied systems. Furthermore, the high complexity and corresponding parameter uncertainty of such models can increase predictive errors; simpler  time-series models may actually perform better \citep{ward_complexity_2014}, though spatial replication can reduce the cost of complexity \citep{Chevalier}. As a result, models used for ecological forecasting will include at least some phenomenological components. But that does not mean that phenomenological forecast models cannot benefit from process-based understanding. Even if process-level understanding does not enable a fully mechanistic model, it can improve the specification of phenomenological models. Our hypothesis is that different processes may be relevant for different forecast horizons, and that we can act on this knowledge by fitting models to different kinds of datasets. 

Here we use two simulated case studies to 1) demonstrate that the best model-building approaches for ecological forecasting 
depend on the time horizon of the forecast, and 2) explore how time-series and space-for-time approaches might be 
combined via weighted averaging to make better forecasts at intermediate time scales. The first case study
focuses on how interspecific interactions affect the population dynamics of a focal species, and the second focuses on
an eco-evolutionary scenario. Our analyses show that: 
\begin{enumerate}
	\item For short-term forecasts, phenomenological time-series approaches are hard to beat, whereas longer-term forecasts require accounting for the influence of slow processes such as evolutionary and ecological selection as well as dispersal.
	\item Different kinds of data reflect the operation of different processes: longitudinal data capture autocorrelation and fast responses of current assemblages to interannual environmental variation, while data spanning spatial gradients capture the long-term outcome of interactions between fast and slow processes.  Whether predictive models should be trained using longitudinal or spatial data sets, or both, depends on the time-scale of the desired forecast.
	\item A key challenge for future research is determining the rate at which slow processes begin to influence dynamics.
\end{enumerate}

\section*{Modeling approach}

In each case study, we simulated the effects of an increase in temperature on simple systems with known dynamics.
The truth was represented by a simulation model that was mechanistic for at least one important process, 
but we treated the data-generating model as unknown when analyzing the data and we assumed that perfectly recovering the mechanisms
it contains would not be possible in practice. We began each simulation
under a stationary distribution of annual temperatures, allowing the system to equilibrate; we call this the baseline phase. 
We then increased temperature progressively over a period of time, followed by a second period of stationary, now elevated, temperature. 
The objective was to forecast the response of the system to the temperature increase based on spatial and/or temporal data 
``sampled" from the simulation during the baseline period. 

We made forecasts based on two phenomenological statistical models, each representing processes operating at different time scales. One statistical model represents the time-series or ``temporal approach.'' We correlated interannual variation in an ecological response with interannual variation in temperature at just one site. The other statistical model relies on a space-for-time substitution, which we call the ``spatial approach'' for brevity. We correlated the mean temperature with the mean of an ecological state or rate across many sites.  We compared forecasts from both statistical models to the simulated dynamics to determine how well the two approaches performed at different forecast horizons. We also assessed the potential for combining the information available in temporal and spatial patterns by using a weighted average of the forecasts from the temporal and spatial approaches optimized to best match the (simulated) observations. We then studied how the optimal model weights changed over time. We expected the temporal approach to best predict short-term dynamics, the spatial approach to best predict long-term dynamics, while the weighted model would show potential to provide the best forecasts at transitional, intermediate time scales. The three statistical models are described in Supporting Information (Appendix \ref{models}). Computer code for both case studies is available for reviewers online (https://drive.google.com/open?id=1aju04qtQvJmZG1mcpN-6hYBZILBhDfl2) and will be archived at Zenodo upon acceptance.

\section*{Community turnover example}

Conservation biologists and natural resource managers often need to anticipate the impact of environmental change on the abundance of 
endangered species, biological invaders, and harvested species. Although the managers may be primarily interested in just one focal species, skillful prediction might require considering interactions with many other species, greatly complicating the problem. But at what forecast horizon do altered species interactions become impossible to ignore? We explored this question using a metacommunity simulation model developed by \cite{alexander_lags_2018} to study how community responses to increasing temperature depend on the interplay between within-site demography and competitive interactions and the movement of species across sites. The model features Lotka-Volterra competitive interactions among plants within sites that are arrayed along an elevation and temperature gradient. Composition varies along the gradient because of a trade-off between growth rate and cold tolerance: cold sites are dominated by slow-growing species that can tolerate low temperatures, while warm sites are dominated by  fast-growing species that are cold intolerant. Multiple species can coexist within sites because all species experience stronger competition from conspecifics than from heterospecifics. Sites are linked by dispersal: a specified fraction of each species' offspring leaves the site where they were produced and reaches all other sites with equal probability. We provide a more detailed description of the simulation model in SI Appendix \ref{metacomm}. \new{Parameter values for the simulations described here in the main text are shown in Table \ref{tab:comm-turn-pars}.}

We first simulated a baseline period with variable but stationary temperature, followed by a period of rapid temperature increase, and then a final period of stationary temperature. Interannual variation in temperature is the same at all sites, but mean temperature varies among sites. All sites experienced the same absolute increase in mean temperature. We focused on the biomass dynamics of one focal species that dominated the central site during the baseline period.

During the baseline period there were strong spatial patterns across the mean temperature gradient. 
Individual species, including our focal species, showed classic, unimodal ``Whittaker" patterns of abundances across the gradient (Fig. \ref{fig:species-patterns-models}A).
These spatial patterns are the basis for our spatial statistical model of the temperature-biomass relationship for our focal species (Fig. \ref{fig:species-patterns-models}A). 
In contrast to the strong spatial patterns, population and community responses to interannual variation in temperature within sites were weak.
At our focal site in the center of the gradient, the biomass of the focal species was quite insensitive to interannnual variation in temperature, but showed strong temporal autocorrelation (Fig. \ref{fig:species-patterns-models}B). Our temporal statistical model estimates this weak, linear temperature effect, along with the strong lag effect of biomass in the previous year. 

We used both the temporal and spatial statistical models to forecast the effect of a temperature increase (Fig. \ref{fig:community-forecast-species}A) on the focal species' biomass at one location in the center of the temperature gradient. 
The predictions from these two models contrasted markedly, with the temporal 
statistical model predicting a large increase in biomass and the spatial statistical model predicting a decrease. Initially, the simulated abundances followed the increase predicted by the 
temporal model, but as faster-growing species colonized and increased in abundance at the focal site, the biomass of the focal species decreased, eventually falling below its baseline level (Fig. \ref{fig:community-forecast-species}B). \new{The qualitative results were the same when we repeated the simulation with a continuous, nonstationary temperature increase (SI Fig. \ref{fig:community-forecast-species-nonstationary}).}

To combine information from the temporal and spatial statistical models into a single prediction, we fit a weighting parameter, $\omega$, which varies over time and is bounded between 0 and 1. At any time point, $t$, this weighted forecast is $\omega \cdot T(N_{t-1},K_t) + (1-\omega) \cdot S(K_t) $ where $T$ is the temporal statistical model, which depends on population size, $N$, and expected temperature, $K$, and $S$ is the spatial statistical model, which depends only on $K$ (see SI Appendix \ref{models} for a full description of the approach). The weighted model accurately predicts the simulated dynamics across the full forecast horizon (Fig. \ref{fig:community-forecast-species}B). It also shows that the most rapid shifts in the model weights occurred during the period when warm-adapted, faster growing species were increasing most rapidly in abundance (Fig. \ref{fig:community-forecast-species}C). However, the reason the weighted models works so well is that the weights were determined by fitting directly to the data. Unlike the forecasts from the spatial and temporal statistical models, we did not generate out-of-sample predictions from the weighted model; it merely provides a convenient way to quantify how rapidly dynamics shift from being dominated by interannual variation captured in the temporal model (time $t=0$ to $t \approx 1250$ in Fig. \ref{fig:community-forecast-species}B) to being dominated by the steady-state equilibrium captured by the spatial model (time $t \geq 2500$). A true forecast from the weighted model would require a method to determine the model weights \emph{a priori}. 

The compositional turnover affecting our focal species also influences total biomass, linking community and ecosystem dynamics. We repeated our focal species analysis for total community biomass, and the results were similar: the temporal statistical model initially made the best forecasts immediately following the onset of the temperature increase, but as the identity and abundances of species at the study site changed, the model weights rapidly shifted to the spatial statistical model (Figs. \ref{fig:community-models-total} and \ref{fig:community-forecasts-total}). 

\section*{Eco-evolutionary example}

Evolutionary adaptation is a key uncertainty in predicting how environmental change will impact a focal population at a given location \citep{Hoffmann2011}. Like the shifts in species composition illustrated in the previous example, shifts in genotype frequencies can also influence dynamics and forecasts at different time scales. Although shifts in genotype frequencies at the population level are analogous to changes in species composition at the community level, the mechanisms are distinct: heterozygosity and genetic recombination have no analogue at the community level. We demonstrate how these processes influence short and long-term forecasts with a standard eco-evolutionary simulation model for a hypothetical annual plant population in which fecundity is temperature dependent, and different genotypes have different temperature optima (Fig. \ref{fig:evo_evo_spatial_temporal_models}A). 

Our model describes how the local density of each genotype changes between years, which depends on temperature and genotype densities in the previous year. Transient temporal dynamics are computed directly from the model; these dynamics are the basis for the temporal statistical model. To create a spatial gradient, we simulated the equilibrium density of each genotype in a series of local populations experiencing different mean temperatures. The pattern of equilibrium densities across the mean annual temperature gradient is the basis for our spatial statistical model: cold sites will be dominated by the cold-adapted homozygous genotype, warm sites will be dominated by the heat-adapted homozygous genotype, and intermediate sites will be dominated by the heterozygous genotype (Fig. \ref{fig:evo_evo_spatial_temporal_models}B). The full description of the eco-evolutionary simulation model is provided in SI Appendix \ref{eco-evo}, and \new{parameter values for simulations described here are shown in Table \ref{tab:eco-evo-pars}.}

The spatial pattern shown in Fig. \ref{fig:evo_evo_spatial_temporal_models}B is the outcome of steady-state conditions. But at any one site, the population's short-term response to temperature will be determined by the dominant genotype's reaction norm (Fig. \ref{fig:evo_evo_spatial_temporal_models}A). For example, at a cold site dominated by the cold-adapted homozygous genotype, a warmer than average year would cause a decrease in population size due to decreases in fecundity (blue line in Fig. \ref{fig:evo_evo_spatial_temporal_models}A), even though the heat-adapted homozygote might perform optimally at that temperature. However, if warmer than normal conditions persist for many years, then genotype frequencies should shift, and the heat-adapted homozygote will compensate for the decreases of the cold-adapted genotype. 

To demonstrate these dynamics, we simulated a diploid annual plant population at a colder than average site. During the baseline period, the population is dominated by the cold-adapted genotype. We used the simulated data from this baseline period to fit a temporal statistical model (Appendix \ref{models}) that predicts population growth rate as a function of annual temperature and population size (Fig. \ref{fig:evo_evo_spatial_temporal_models}C), assuming no knowledge of the underlying eco-evolutionary dynamics. We then imposed a period of warming, followed by a final period of higher stationary temperature (Fig. \ref{fig:forecast} top).

With the onset of warming, the population crashed as the cold-adapted genotype decreased in abundance. Eventually, frequencies of the heterozygous genotype and the warm-adapted homozygous genotype began to increase and the population recovered (Fig. \ref{fig:forecast} bottom). The temporal statistical model (solid blue line in Fig. \ref{fig:forecast}) accurately predicted the impact of the initial warming trend, but eventually became too pessimistic, while the spatial statistical model (solid red line in Fig. \ref{fig:forecast}) did not handle the initial trend but accurately predicted the eventual, new steady state (Fig. \ref{fig:forecast} bottom).

As in the community turnover example, we also fit a weighted average of predictions from the spatial and temporal statistical models, with the weights changing over time. This weighted model initially reflected the temporal model (decrease from $t=500$ to $t=600$), but then rapidly transitioned to reflect the spatial model ($t \geq 700$). The rapid transition in the weighting term, $\omega$, occurred during the period of most rapid change in genotype frequencies (Fig. \ref{fig:forecast_supp}). The weighted model's predictions look impressively accurate, but, as in the community turnover example, that is because we used the full, simulated time series to fit the weighting term. A true forecast would require an independent method to predict how the model weights shift over time.

\section*{Discussion}

Ecological forecasts are typically made using either a space-for-time substitution approach based on models fit to spatial data or using dynamic models fit to time-series data. Our results demonstrate that these two approaches can make very different predictions about the future state of ecological systems. Which approach provides the most accurate forecasts depends on the forecast-horizon. In our simulations, time-series approaches performed best for short forecast horizons, whereas models based on spatial data made more accurate forecasts at long horizons. In addition, our simulations demonstrate extended transitional periods during which neither the time-series or the spatial approach was effective on its own. The challenge is determining what is ``short-term,'' what is ``long-term,'' and how to handle the many forecasts we need in ecology which fall in between. We have proposed that a weighted combination of the time-series and space-for-time approaches may produce better forecasts at these intermediate forecast horizons.

We designed our simulation studies to illustrate how the change in statistical model performance with increasing forecast horizon reflects differences in the types and scales of processes captured by spatial and temporal data sets. How could these hypotheses be tested with empirical data? The hypothesis that time-series models will be most effective for near-term forecasts already has empirical support, in the form of recent analyses of biodiversity forecasts at time scales from one to ten years \citep{harris_forecasting_2018}. The result should not be surprising, since local time-series data capture demographic processes, lagged effects, and responses of current assemblages to small changes in environmental conditions. In addition, the state of the system in the near future depends heavily on the current state. Since short-term forecasts do not typically require extrapolating into novel conditions, a model based on the historical range of variation which incorporates lags and accurate initial conditions is likely to be successful.

Space-for-time modeling approaches for predicting long-term, steady-state outcomes of ecological change have also been tested empirically, primarily via hind-casting. Overall, the results are mixed: some tests show reasonable prediction of changes in community composition \citep{Blois2013,Illan2014} or species distributions \citep{Norberg2019}, supporting the hypothesis that datasets spanning spatial gradients capture the long-term outcome of interactions between fast processes and slower processes such as ecological and evolutionary selection, dispersal, and responses to large changes in the environment. Other attempts to validate predictions from space-for-time models have been discouraging \citep{Worth2014,Illan2014,Davis2014,Brun2016,Veloz2012}, indicating violations of model assumptions or effects of transient dynamics. However, predictions from the space-for-time approaches are rarely compared directly to predictions from time-series models (\citealt{harris_forecasting_2018} but see \citealt{Renwick2018}). We need more such comparisons to identify the appropriate modeling approach for different forecast horizons. 

The greatest empirical challenge will be testing our hypothesis that a weighted average of spatial and temporal statistical models will make the best forecasts at intermediate time scales. There are two problems: finding appropriate data and determining the model weights \emph{a priori}. Many data sets have both a longitudinal and spatial dimension, but we could not think of one which also featured a clear ecological response to significant environmental change. Surely such datasets exist, and we hope researchers who work with them will test our proposed weighted model. Determining model weights may be more difficult. In our simulations, we fit the weights directly to the simulated data, which is impossible to do for actual forecasting when the future is unknown. We need new theory or empirical case studies in order to assign these weights \emph{a priori}. 

Theory could explore the influence of different parameters on the rate at which slow processes begin to influence dynamics. The effects of some parameters are intuitive: in the community turnover example, increasing the fraction of dispersing individuals caused a more rapid shift in species composition and in model weights (Fig. \ref{fig:dispersal_niche_width}A). Other parameters have less intuitive effects: we expected that increasing the temperature tolerance of genotypes in the evo-evolutionary example would accelerate the shift in model weights by maintaining higher genetic diversity. Our simulations showed the opposite effect, with wider tolerances slowing the shift in model weights (Fig. \ref{fig:dispersal_niche_width}B), presumably by decreasing the strength of selection. Additional factors to consider include organism lifespans and the magnitude of directional environmental change relative to historical interannual variation. 

Empirical research could inform model weights by accumulating enough case studies to infer patterns in the weighting functions and guide applications in new systems. Developing  rules of thumb would require testing many forecasts from both time-series and spatial models across a range of time-horizons. This effort may require a novel integration of typically disparate approaches, such as analyses of paleoecological data (e.g., \citealt{Worth2014}), long-term observational (e.g., \citealt{Nice2019}) or experimental data (e.g., \citealt{Silvertown2006}), and model systems with short-generation times (e.g., \citealt{Good2017}).

Given the challenges of determining model weights \emph{a priori}, we should also pursue alternatives for intermediate forecast horizons. In the Introduction, we argued that fully process-based models are not feasible. However, a new class of statistical models offers a compromise between mechanistic detail and phenomenological feasibility. Spatiotemporal statistical modeling approaches are being developed to study patterns and processes of interest to ecological forecasters, such the spread of an invasive species or population status of a threatened species  \citep{Wikle2003,Williams2017,Schliep2018}. Because these models include both fast processes, such as births and deaths, and slower processes, such as colonization and extinction dynamics, they have the potential to make better predictions at intermediate forecast horizons than purely spatial or temporal models. However, these spatiotemporal models have rarely been used in a forecasting context, due to a combination of data limitation and computational challenges. Many data sources contain either spatial or temporal variation, but not both, and when spatiotemporal datasets are available they often involve irregular sampling, creating challenges for modeling. Fitting and generating predictions from spatiotemporal models is also computationally intensive, especially with large datasets \citep{McDermott2017}. Fortunately, thanks to large-scale monitoring efforts from remote sensing platforms, the National Ecological Observatory Network (https://www.neonscience.org/), and community science projects (e.g., eBird), large scale spatiotemporal data is increasingly available. In addition, new methods for spatiotemporal forecasting are being developed that address existing computational challenges \citep{McDermott2017}, and access to high performance computing resources is increasingly common. Given these developments, future ecological forecasting efforts should explore spatiotemporal approaches and assess whether they improve predictions at intermediate time scales relative to traditional time-series or space-for-time approaches.

Our results have important implications for the emerging field of ecological forecasting. First, they suggest that evaluating model performance at both short and long forecsat horizons will be essential as research on forecasting methods accelerates. Second, while single approaches may perform reasonably well for either short or long horizons, skillful predictions at intermediate forecast horizons may require a combination of information from spatial and temporal statistical models. Intermediate time horizons pose challenges in other forecasting contexts as well. Weather forecasts based on regional-scale meteorological models are very effective for forecasting a week to ten days in advance, but then become largely uninformative. Forecasting these intermediate scales has been challenging in meteorology and will likely be challenging in ecology as well. While the recent emphasis on near-term iterative forecasting \citep{dietze_iterative_2018} is the logical and tractable starting point, we also need to build understanding and capacity for forecasting ecological dynamics across all forecast horizons of interest.

\subsubsection*{Data accessibility statement:} The manuscript contains no original data. All computer code is available for reviewers in a zip archive that can be downloaded from Google Drive: https://drive.google.com/open?id=1aju04qtQvJmZG1mcpN-6hYBZILBhDfl2. Upon acceptance of the manuscript, code will be archived at Zenodo.



\newpage
\renewcommand{\refname}{Literature cited}
\bibliographystyle{ecography}
\bibliography{references}

\newpage

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.7 \textwidth] {fast-slow-figure.png}
	\caption{Fast and slow processes operate at different time scales, and are reflected in different kinds of datasets. Fast processes, such as births, deaths, and individual growth, operate at all time scales, but are the exclusive drivers of the short-term dynamics captured in most time series datasets. Slower processes, such as evolutionary selection on genotype frequencies, ecological selection on species abundances, and colonization and extinction, interact with fast processes to drive dynamics over the long-term. The influence of these slow processes is seen in very long time series, or in spatial gradients. Understanding dynamics at intermediate time scales requires integrating information from spatial and temporal data sources. We propose a model weighting approach; mechanistic spatiotemporal modeling is another alternative. The time scales shown here were chosen with vascular plants in mind, but the same concepts would apply for much shorter-lived organisms but at shorter time scales.  }
	\label{fig:fast-slow-concept}
\end{figure}

\clearpage

\begin{figure}[tbp]
	\centering
	\includegraphics[width=1 \textwidth] {species_patterns_models.png}
	\caption{(A) Mean biomass by species (colors) across the temperature gradient during the baseline period. The focal species, dominant at the site in the center of the gradient (vertical gray line), is shown in dark blue. The dashed blue line shows predictions from the spatial statistical model. (B) Annual biomass of the focal species at the central site during the baseline period. The dashed line shows predictions from the temporal statistical model. }
	\label{fig:species-patterns-models}
\end{figure}

\clearpage

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.7 \textwidth] {community_forecast_species.png}
	\caption{(A) Simulated annual temperatures (grey) and expected temperature (black), which was used to make forecasts, at the focal site. (B) Simulated focal species biomass and forecasts from the spatial, temporal and weighted statistical models at the focal site in the metacommunity model. (C) Simulated changes in biomass of the focal species (black) and all other species (grey), and the weight given to the temporal statistical model for focal species biomass (blue). Year 1000 in each panel corresponds to the start of the temperature increase. }
	\label{fig:community-forecast-species}
\end{figure}

\clearpage

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.4 \textwidth]{spatial&temporal_model.png}
	\caption{(A) Reaction norms of the three genotypes. (B) The spatial pattern of individual genotypes (colors) and total population abundance (black) at sites arrayed across a gradient of mean annual temperature. The dashed black line (almost entirely hidden by the slid black line) shows predictions from an empirical, spatial statistical model, a linear regression that describes mean population size as a function of mean temperature. (C) The relationship between annual temperature and per capita growth rate at a location with a mean temperature that favors the cold-adapted genotype. Colors show population size (the green to brown gradient depicting low to high population density), which influences the population growth rate through density dependence. }
	\label{fig:evo_evo_spatial_temporal_models}
\end{figure}

\clearpage

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.7 \textwidth] {forecast.png}
	\caption{(Top) Simulated annual temperatures (grey) and expected temperature (black), which was used to make forecasts. (Bottom) Simulated population size and forecasts from the spatial, temporal and weighted statistical models.  }
	\label{fig:forecast}
\end{figure}

\clearpage

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.7 \textwidth] {dispersal_niche_width.png}
	\caption{The rate of change in the weight of the temporal forecast (y-axis) depends on (A) the fraction of propagules dispersing in the community turnover example and (B) on the temperature tolerance of genotypes, given by $\sigma_T$ (larger values indicate wider thermal niches) in the eco-evolutionary example. Year 0 in these figures corresponds to the start of the temperature increase. }
	\label{fig:dispersal_niche_width}
\end{figure}


%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% APPENDICES !
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\clearpage 
\newpage 

\setcounter{page}{1}
\setcounter{equation}{0}
\setcounter{figure}{0}
\setcounter{section}{0}
\setcounter{table}{0}

\centerline{\Large \textbf{Appendices}}

\renewcommand{\thesection}{\Alph{section}}

\section{Spatial, temporal and spatial-temporal-weighted models}\label{models}

The two simulation models in the main text describe how population size, $N(x,t)$, at location $x$ changes over time ($t$). We assume that the temperature, $K(x,t)$, at each location can vary in time and space. To forecast the dynamics generated by these simulations models, we fit a series of statistical models.   

The spatial model, which we refer to as $S$, is a quadratic regression of the mean long-term population density at a location ($\bar{N}(x)$) against the mean temperature at that location ($\bar{K}(x)$).  The quadratic term describes the unimodal relationship between $\bar{N}$ and $\bar{K}$. The spatial statistical model is
\begin{equation}
\bar{N}(x) = S(\bar{K}(x)) = \beta^S_0 +  \beta^S_1 \bar{K}(x) +\beta^S_2 {\bar{K}(x)}^2 + \varepsilon
\label{eqn:spatial_regression}
\end{equation}

The temporal model, which we call $T$, starts with a time-series of ``observed" population sizes, or total biomasses, at one location, $N(t)$, for $t=1...n$ (the spatial index is suppressed because we only focus on one location at a time). In the community turnover example, we fit the following regression, which predicts biomass at time $t+1$ as a function of biomass ($N(t)$) and annual temperature ($K(t)$) at time $t$,
\begin{equation}
\ln(N(t+1)) = T(N(t),K(t)) = \beta^T_0 +  \beta^T_1 \ln(N(t)) +\beta^T_2 K(t)  +  \varepsilon
\label{eqn:temporal_regression_community1}
\end{equation}
In the eco-evolutionary example, the response variable is the log of the population growth rate. The regression is 
\begin{equation}
\ln\left(\frac{N(t+1)}{N(t)}\right) = T(N(t),K(t)) = \beta^T_0 +  \beta^T_1 \ln(N(t)) +\beta^T_2 K(t)  +\beta^T_3 K(t)^2 +  \varepsilon
\label{eqn:temporal_regression_ecoevo2}
\end{equation}
This version of the temporal model returns a per capita growth rate on the log scale. To predict population size at the next time step, we exponentiate the growth rate and multiply it by the current population size: $\exp(T(N(t),K(t))) N(t)$.

The weighted model is a weighted average of predictions from the spatial and temporal models, with the weights changing as a function of time, here expressed as the forecast horizon. The weights change as a function of the square root of the forecast horizon, to allow rapid shifts in the model weights. 
\begin{equation}
logit(\omega_t)=\beta^W_0 + \beta^W_1 \sqrt{t}
\label{eqn:weights}
\end{equation}
For the community turnover example, the predicted biomass from the weighted model is:
\begin{equation}
\hat{N}(t+1)= \omega \cdot T(N(t),K(t)) + (1-\omega) \cdot S(K(t)) 
\label{eqn:combined_model1}
\end{equation}
Again, we suppress the spatial subscript ($x$) here because we are focused on densities at just one location. For the eco-evolutionary example, the predicted population size from the weighted model is:
\begin{equation}
\hat{N}(t+1) = \omega \cdot \exp(T(N(t),K(t))) N(t) + (1-\omega) \cdot S(K(t)) 
\label{eqn:combined_model2}
\end{equation}

We used the \texttt{optim} function to estimate the $\beta^W$s that minimize the sum of squared errors, $(\hat{N}(t+1) - N(t+1))^2$.

In the main text, we show the point forecasts but not the uncertainty around the forecasts. After exploring that uncertainty, we decided that presenting it would be misleading. For the spatial and, especially, the temporal statistical models, the uncertainty is unrealistically low, because the models are estimated with very large samples sizes from the simulations. Furthermore, the simulations do not include noise; the only reason there is any uncertainty is because the statistical models are slightly mis-specified with respect to the process models. Showing uncertainty for the weighted model would be even less meaningful, because it is not a true, out-of-sample forecast (parameters are fit directly to the observations for which we make predictions). The R code to compute uncertainties for the spatial and temporal forecasts is available on our Github repository (https://github.com/pbadler/space-time-forecast), but is commented out.

\section{Description of the meta-community model}\label{metacomm}

\cite{alexander_lags_2018} developed a meta-community model to represent dynamics of local communities arrayed along a one-dimensional elevation gradient, as influenced by three main processes: temperature-dependent growth, competition, and dispersal. Here we adapt their notation to be consistent with our own.

The population size of species $i$ in cell $x$ at time $t + 1$, $N_{i}(x,t+1)$, is computed in two steps. The first step accounts for changes in local population sizes due to dispersal. In each local community, all species export a fraction ($d$) of their local population to the two adjacent communities in the 1-dimensional landscape:
\begin{equation}
N'_{i}(x,t) = (1-d) \cdot N_{i}(x,t) + \frac{d}{2} \cdot (N_{i}(x+1,t) + N_{i}(x-1,t))
\end{equation}
Here $N'$ distinguishes the post-dispersal population size from the pre-dispersal population size.

The second step computes population growth, taking into account competition:
\begin{equation}
N_{i}(x,t+1) = N'_{i}(x,t) + N'_{i}(x,t)[g_i(K(x) - Kmin_i) - c_i N'_{i}(x,t) - l_i \sum_{k} N'_{k}(x,t)]
\end{equation}
In the absence of competition, the growth rate ($g_i$) is determined by the difference between the temperature at site $x$ ($K(x)$) and the focal species' minimum temperature tolerance, $Kmin_i$, the lowest temperature at which a species can maintain a positive growth rate. Growth is further reduced by intraspecific and interspecific competition, parameterized by $c_i$ and $l_i$.  All species are assigned the same value of $c_i$, which represents an additional effect of intraspecific competition on top of interspecific competition. This stabilizes coexistence, since every species will exert stronger intra- than interspecific competition. However, values of $l$ vary among species to create a trade-off between growth rates and competitive ability versus low temperature tolerance: fast-growing species (high $g_i$) are more tolerant of interspecific competition (low $l_i$) but are more limited by temperature (high $Kmin_i$).

\new{To assign species-specific parameter values, the number of species in the metacommunity is specified. Next, each species is assigned an optimal temperature within a specified temperature range by drawing from a uniform distribution. Sensitivity to interspecific competition is then determined as a decreasing function of optimal temperature. Calculations are performed in the script \texttt{SpeciesPoolGen.R}.   }

\section{Description of the eco-evolutionary annual plant model}\label{eco-evo}

%\renewcommand{\theequation}{B-\arabic{equation}}
%\renewcommand{\thetable}{B-\arabic{table}}
%\renewcommand{\thefigure}{B-\arabic{figure}}

\noindent \textbf{Haploid Model:} Begin with a haploid model that describes the number of seeds present in a seed bank.  $N_{i,t}$ is the number of seeds of species $i$ at time $t$. The model is
\begin{align}\begin{split}
N_{1,t+1} &= s_1 [1-g_1]N_{1,t}+\frac{\lambda_1(K(t))g_1N_{1,t}}{1+ \alpha_{11}g_1N_{1,t} + \alpha_{12}g_2N_{2,t}}\\
N_{2,t+1} &= s_2 [1-g_2]N_{2,t}+\frac{\lambda_2(K(t))g_2N_{2,t}}{1+ \alpha_{21}g_1N_{1,t} + \alpha_{22}g_2N_{2,t}}
\end{split}\end{align}
where $g_{i}$ is the probability of germination for species $i$, $s_i$ is the seed survival probability, $\lambda_{i}(K(t))$ is the seed production rate per plant, and $K(t)$ is the temperature at time $t$.  Below we refer to the $\alpha_{ij}$ as intra- and inter-genotype competition coefficients.  

\noindent \textbf{Diploid Model:} Consider a one-species diploid model.  The genotypes are denoted by $AA$, $Aa$, and $aa$.   The number of each genotype at time $t$ is $N_{AA}(t)$, $N_{Aa}(t)$, and $N_{aa}(t)$.  The germination rates for each genotype are $g_{AA}$, $g_{Aa}$, and $g_{aa}$.  The seed survival probability and seed production rate for genotype $AA$ are $s_{AA}$ and $\lambda_{AA}(K(t))$, respectively.  The analogous parameters for the other genotypes are similarly denoted.  The competition coefficients are denoted by $\alpha_{i,j}$, e.g., $\alpha_{AA,AA}$ or $\alpha_{AA,Aa}$.  Throughout we assume that gametes mix randomly in the population.  

First consider the case where the competition coefficients are zero ($\alpha_{i,j}=0$).  Let $T$ denote the total number of gamete-pairs produced in a given year,
\begin{equation}
T = \lambda_{AA}(K(t))N_{AA}(t)g_{AA} + \lambda_{Aa}(K(t))N_{Aa}(t)g_{Aa} +\lambda_{aa}(K(t))N_{aa}(t)g_{aa}.
\end{equation}
The first term is the number of gamete-pairs produced by $AA$ individuals.  The second and third terms are the numbers of gamete-pairs produced by $Aa$ and $aa$ individuals, respectively. The proportion of $A$ gametes ($\phi_A$) and the proportion of $a$ gametes ($\phi_a$) are given by
\begin{align}\begin{split}
\phi_{A} &= \frac{\lambda_{AA}(K(t))N_{AA}(t)g_{AA}+ \frac{1}{2}\lambda_{Aa}(K(t))N_{Aa}(t)g_{Aa}}{T} \hspace{10pt} \text{and} \hspace{10pt} \phi_a = 1-\phi_{A}.
\end{split}\end{align}
Note that the $T$ in the denominator of $\phi_A$ shows up because we are computing proportions.  Combining all of these we get the dynamics for each genotype,
\begin{align}\begin{split}
N_{AA}(t+1) &= s_{AA}[1-g_{AA}]N_{AA}(t) + \phi_A^2T\\
N_{Aa}(t+1) &= s_{Aa}[1-g_{Aa}]N_{Aa}(t) + \phi_A\phi_aT\\
N_{aa}(t+1) &= s_{aa}[1-g_{aa}]N_{aa}(t) + \phi_a^2T
\end{split}\end{align}

Now consider the case where the competition coefficients are non-zero ($\alpha_{i,j}\neq0$).  Including competition changes the way in which we compute $T$, $\phi_A$, and $\phi_a$.  Specifically, because the total number of seeds produced per year by each genotypes is reduced based on intra- and inter-genotype competition, the total number of gamete-pairs becomes
\begin{align}\begin{split}
T &=  \frac{\lambda_{AA}(K(t))N_{AA}(t)g_{AA}}{1+ \alpha_{AA,AA}g_{AA}N_{AA}(t) + \alpha_{AA,Aa}g_{Aa}N_{Aa}(t)+ \alpha_{AA,aa}g_{aa}N_{aa}(t)} \\ 
&+ \frac{\lambda_{Aa}(K(t))N_{Aa}(t)g_{Aa}}{1+ \alpha_{Aa,AA}g_{AA}N_{AA}(t) + \alpha_{Aa,Aa}g_{Aa}N_{Aa}(t)+ \alpha_{Aa,aa}g_{aa}N_{aa}(t)}\\
&+\frac{\lambda_{aa}(K(t))N_{aa}(t)g_{aa}}{1+ \alpha_{aa,AA}g_{AA}N_{AA}(t) + \alpha_{aa,Aa}g_{Aa}N_{Aa}(t)+ \alpha_{aa,aa}g_{aa}N_{aa}(t)}.
\label{eqn:defineT}
\end{split}\end{align}
The first line is the number of gamete-pairs produced by $AA$ individuals after accounting for the effects of competition.  The second and third lines are the numbers of gamete-pairs produced by $Aa$ and $aa$ individuals, respectively. The proportions of $A$ gametes and $a$ gametes are 
\begin{align}\begin{split}
\phi_A &= \frac{1}{T}\frac{\lambda_{AA}(K(t))N_{AA}(t)g_{AA}}{1+ \alpha_{AA,AA}g_{AA}N_{AA}(t) + \alpha_{AA,Aa}g_{Aa}N_{Aa}(t)+ \alpha_{AA,aa}g_{aa}N_{aa}(t)} \\
&+ \frac{1}{2T}\frac{\lambda_{Aa}(K(t))N_{Aa}(t)g_{Aa}}{1+ \alpha_{Aa,AA}g_{AA}N_{AA}(t) + \alpha_{Aa,Aa}g_{Aa}N_{Aa}(t)+ \alpha_{Aa,aa}g_{aa}N_{aa}(t)}\\
\phi_a &= 1- \phi_A
\label{eqn:definePhi}
\end{split}\end{align}
Combining all of this results in the same model as above,
\begin{align}\begin{split}
N_{AA}(t+1) &= s_{AA}[1-g_{AA}]N_{AA}(t) + \phi_A^2T\\
N_{Aa}(t+1) &= s_{Aa}[1-g_{Aa}]N_{Aa}(t) + 2 \phi_A\phi_aT\\
N_{aa}(t+1) &= s_{aa}[1-g_{aa}]N_{aa}(t) + \phi_a^2T,
\end{split}\end{align}
but the definitions of $T$, $\phi_A$, and $\phi_a$ are given by equations (\ref{eqn:defineT}) and (\ref{eqn:definePhi}) . 

\newpage 

\section*{Supplementary Tables}

\renewcommand{\thetable}{S-\arabic{table}}

\begin{table}[htp]
	\caption{\label{tab:comm-turn-pars}Parameters and parameter values for the community turnover case study. Values are assigned at
		the start of \texttt{comm\_turn\_master.R}. ``Name" refers to the variable declared in the computer code. These names do not exactly 
		match the symbols shown in the equations in Appendix \ref{metacomm}; rather, the species-specific values of those parameters are calculated in the computer code based on the values in this table.  }
	\centering
	\smallskip 
	\begin{tabular}{lrl}
		\hline
		Name & Value & Definition \\
		\hline
		L\_land & 20 & Length of landscape \\
		Tmin & 0 &  Minimum of spatial gradient in baseline temperature \\ 
		Tmax & 15 &  Maximum of spatial gradient in baseline temperature \\
		Tstdev & 2 &  Standard deviation of temperature (interannual variation) \\
		deltaT & 4  & Magnitude of directional change in temperature \\
		burnin\_yrs & 2000 & Number of years to initialize simulation \\
		baseline\_yrs & 1000  & Number of years at baseline temperature used to fit statistical models \\
		warming\_yrs  & 200 & Number of years over which temperature increases \\
		final\_yrs & 2000  & Number of years at steady-state, elevated temperature \\
		\hline
		N & 40 & Number of species \\
		Gmax & 0.5 & Maximum population growth rate \\
		Gmin & 0.2 & Minimum population growth rate \\
		Lmax & 1.5 & Maximum sensitivity to competition \\
		Lmin & 0.7 & Minimum sensitivity to competition  \\
		Cmax & 0.2 & Maximum additional sensitivity to conspecific competition \\
		Cmin & 0.2 & Minimum additional sensitivity to conspecific competition \\
		d & 0.01 &  Fraction of offspring dispersing from home site \\
		\hline
	\end{tabular}
\end{table}


\begin{table}[htp]
	\caption{\label{tab:eco-evo-pars}Parameters and parameter values for the eco-evolutionary case study. Values are assigned at
		at the start of \texttt{genetic\_diversity\_master.R}. ``Name" refers to the variable declared in the computer code. Where appropriate, the corresponding symbols from equations in Appendix \ref{eco-evo} are shown in parentheses. }
	\centering
	\smallskip 
	\begin{tabular}{lrl}
		\hline
		Name & Values & Definition \\
		\hline
		Tstdev & 1 & Standard deviation of temperature (interannual variation) \\
		baseT & -1 & Baseline temperature \\
		deltaT & 5 & Total change in temperature \\
		baseline\_yrs & 500 & Number of years at baseline temperature used to fit statistical models \\
		warming\_yrs & 100  & Number of years over which temperature increases \\
		final\_yrs & 300  & Number of years at steady-state, elevated temperature \\
		\hline
		fec\_Tmu & -1,0,1  & Optimal fecundity temperature for genotypes AA, Aa, and aa \\
		fec\_Tsigma & 8  & Standard deviation in fecundity for all genotypes \\
		fec\_max & 100 &  Maximum fecundity for all genotypes \\
		G ($g$) & 1 & Germination rate for all genotypes \\
		seedSurv ($s$)  &  0.5  & Survival rate for ungerminated seeds of all genotypes \\
		alpha ($\alpha$) & 1  &  All competition coefficients for all genotypes \\
		\hline
	
	\end{tabular}
\end{table}


\clearpage

\section*{Supplementary Figures}

\renewcommand{\thefigure}{S-\arabic{figure}}

\clearpage

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.7 \textwidth] {community_forecast_species_nonstationary.png}
	\caption{(A) Simulated annual temperatures (grey) and expected temperature (black), which was used to make forecasts, at the focal site. \new{In contrast to Fig. \ref{fig:community-forecast-species}, which shows results for a period of warming followed by stationary temperatures, for this simulation we spread the same temperature increase out over a longer period with no return to stationarity.} (B) Simulated focal species biomass and forecasts from the spatial, temporal and weighted statistical models at the focal site in the metacommunity model. (C) Simulated biomass of the focal species (black) and all other species (grey), and the weight given to the temporal statistical model for focal species biomass (blue). Year 1000 in each panel corresponds to the start of the temperature increase.   }
	\label{fig:community-forecast-species-nonstationary}
\end{figure}

\begin{figure}[!ht]
\centering
\includegraphics[width=0.7 \textwidth] {community_models_total.png}
\caption{(Results for total biomass from the community turnover model. Blue points show mean total biomass during the baseline period at locations across the temperature gradient, and the blue line shows predictions from the spatial model. Red points show annual total biomass during the baseline period as a function of annual temperature at the central site on the gradient. The red line shows predictions from the temporal model.   }
\label{fig:community-models-total}
\end{figure}

\begin{figure}[tbp]
\centering
\includegraphics[width=0.7 \textwidth] {community_forecast_total.png}
\caption{Results for total biomass from the community turnover model. (A) Simulated annual temperatures (grey) and expected temperature (black), which was used to make forecasts, at the focal site. (B) Simulated total biomass and forecasts from the spatial, temporal and weighted models. (C) Simulated changes in biomass of all species (grey) at the focal site in the metacommunity model, and the weight given to the temporal model for total biomass (blue). Year 1000 in this figure corresponds to the start of the temperature increase.  }
\label{fig:community-forecasts-total}
\end{figure}


\begin{figure}[tbp]
\centering
\includegraphics[width=0.7 \textwidth] {forecast_supplement.png}
\caption{Simulated shifts in genotype abundances, and the model weighting term, $\omega$, during the warming phase and the following stationary temperature phase. Year 0 in this figure corresponds to the start of the temperature increase.}
\label{fig:forecast_supp}
\end{figure}


\end{document}

